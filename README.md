# Polymorphic-Malware-Training

A toy demo of how polymorphic malware works in theory and a presentation link.

# General Information

- Author: Corey Hartman

# Contents

- Self-Mod-1:
A toy self mutating piece of code that recieves polymorphic shellcode remotely.
- Self-Mod-2:
A toy self mutating piece of code that creates its own mutated source code locally.
- c2_server.py:
Self-Mod-1's c2 server it reaches out to for shellcode.
- c2_communications.pcap:
A pcap showing c2 shellcode payloads mutated on the network.

# Why You Should Care

According to the 2018 Webroot threat report, polymorphic techniques were utilized in 94% of malware. Understanding how polymorphic malware works and how it is developed is important for you as a cyber security professional, to aid in detection and to allow you to understand why detection in general of polymorphic malware can be complicated. For offensive security, understanding development techniques can aid in new methodologies of attack to better perform your job and give new perspectives on offensive security tactics. With mutation engines easily churning out billions of non-deterministic keys for encrypting instructions to create polymorphic malware, cyber security professionals and current technology is unable to keep up with the constantly mutating polymorphic malware in the wild. With some malware now having cross-architecture capabilities, polymorphic malware infections may increase with the often low security standards in IoT devices.

# Three main ideas:

1. Polymorphic malware constantly changes its static signatures using encryption, traditional anti-virus techniques do not work well for detection as small change will result in a different signature.
2. Reverse engineering polymorphic malware is difficult, techniques to hide code make it difficult to spot polymorphic and self modifying behavior. Often reverse engineer tools do not detect shellcode used for self-modification, as it is seen as data.
3. Polymorphic malware detection generally requires the malware to be already executing to detect malicious decrypted instructions in memory.

# The Future

New techniques to detect polymorphic malware are needed, as this type of malware is not going away anytime soon. Current techniques are weak and require the malware to already be executing for detection to occur, rather than preventing infection in the first place. 

# Presentation link

[Link](https://youtu.be/dr57jwztuGs)
